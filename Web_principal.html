<!doctype html>
<html lang="es">
<head> <!--Aqui van configuraciones generales, enlaces a librerias, estilos globales, metadatos. Es como la bodega de planos-->
  <meta charset="utf-8" /> <!--hace que exista la "帽" y las tildes, sin que la wea crache-->
  <meta name="viewport" content="width=device-width, initial-scale=1" /> <!--Resposividad para celulares-->
  <title>Bocatto | Pedir</title> <!--Titulo de la pagina, lo que se ve en la barra de busqueda, despues del www.-->

  <!-- Importamos Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Importamos Bootstrap Icons (para iconitos tipo carrito, login, etc.) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Importamos Google Font para estilos de letra, lo ocuparemosel navbar -->
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500&display=swap" rel="stylesheet">

  <!--"<style>" son bloques en los que se puede escribir en CSS, aqui solo lo hacemos con estas estrcuturas, porque bootstrap no las tiene por defecto-->
  <style>
    /* Personalizaci贸n del navbar */
    .navbar {
      font-family: 'Oswald', sans-serif; /* Fuente solo para navbar */
      font-size: 1.1rem; /* Texto un poquito m谩s grande */
    }
    /* Fondo general de la p谩gina */
    body {
      background-color: #111;  /* negro suave */
      color: #f7f7f7;          /* texto claro */
    }
    /* ===== Carrusel ===== */
    #heroCarousel img {
      height: 450px;         /* altura moderada */
      object-fit: cover;     /* ajusta la imagen sin deformarla */
    }
  </style>
</head>

<!--Aqui se empiesan a armas las estrcuturas-->
<body>

<!-- =================== NAVBAR SUPERIOR =================== -->

<nav class="navbar navbar-expand-lg navbar-light bg-warning px-3">
  <div class="container-fluid">

    <!-- Logo + Nombre -->
    <a class="navbar-brand d-flex align-items-center" href="Web_principal.html">
      <img src="Recursos_Esteticos/img/logo.png" alt="Bocatto" width="40" height="40" class="me-2">
      <span class="fw-bold">Bocatto</span>
    </a>
    <!-- Bot贸n para men煤 hamburguesa en m贸viles -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Contenido colapsable -->
    <div class="collapse navbar-collapse justify-content-center" id="navbarContent">
      <ul class="navbar-nav mb-2 mb-lg-0 gap-3">
        <li class="nav-item">
          <a class="nav-link" href="Menu.html"> <!--Link al menu-->
        <i class="bi bi-pizza"></i> Men煤
        </a>

        </li>
        <li class="nav-item">
          <a class="nav-link" href="#promos">
            <i class="bi bi-fire"></i> Promos <!--  icono de promos -->
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#locales">
            <i class="bi bi-geo-alt"></i> Locales y horarios <!--  icono de ubicaci贸n -->
          </a>
        </li>
      </ul>
    </div>

    <!-- Botones a la derecha -->
    <div class="d-flex gap-2">
      <!-- Bot贸n login -->
      <button class="btn btn-outline-dark" id="btn-login" data-bs-toggle="modal" data-bs-target="#loginModal">
        <i class="bi bi-box-arrow-in-right"></i> Iniciar sesi贸n
      </button>

      <!-- Bot贸n pedidos (solo clientes) -->
      <button class="btn btn-dark" id="btn-pedidos" hidden>
        <i class="bi bi-bag"></i> Tus pedidos
      </button>

      <!-- Bot贸n carrito (solo clientes) -->
      <button class="btn btn-warning position-relative" id="btn-carrito" hidden>
        <i class="bi bi-cart"></i>
        <!-- contador rojo -->
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="cart-count">
          0
        </span>
      </button>

      <!-- Bot贸n panel admin -->
      <button class="btn btn-danger" id="btn-admin" hidden>
        <i class="bi bi-gear-fill"></i> Panel Admin
      </button>

      <!-- Bot贸n logout -->
      <button class="btn btn-secondary" id="btn-logout" hidden>
        <i class="bi bi-box-arrow-right"></i> Cerrar sesi贸n
      </button>
    </div>
        </div> <!-- cierre d-flex gap-2 -->
  </div> <!-- cierre container-fluid -->
</nav> <!-- cierre navbar -->



<!-- =================== CARRUSEL HERO =================== -->

<div id="heroCarousel" class="carousel slide mb-4" data-bs-ride="carousel">

  <!-- Indicadores (puntitos abajo) -->
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
    <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
  </div>

  <!-- Slides -->
  <div class="carousel-inner">

    <!-- Slide 1 -->
    <div class="carousel-item active">
      <img src="Recursos_Esteticos/img/hero1.jpg" class="d-block w-100" alt="Promo 1">
      <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-2">
        <h5>隆Pepperoni a precio vecino!</h5>
        <p>Solo por hoy. Pide y retira en tienda.</p>
        <a href="#promos" class="btn btn-danger">Ver promos</a>
      </div>
    </div>

    <!-- Slide 2 -->
    <div class="carousel-item">
      <img src="Recursos_Esteticos/img/hero2.jpg" class="d-block w-100" alt="Promo 2">
      <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-2">
        <h5>Nuevo Panini Caprese</h5>
        <p>Mozzarella, tomate, pesto y albahaca.</p>
        <a href="#menu" class="btn btn-danger">Ir al men煤</a>
      </div>
    </div>

    <!-- Slide 3 -->
    <div class="carousel-item">
      <img src="Recursos_Esteticos/img/hero3.jpg" class="d-block w-100" alt="Promo 3">
      <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-2">
        <h5>Combo Baguette + Bebida</h5>
        <p>Para llevar y compartir.</p>
        <a href="#promos" class="btn btn-danger">Aprovechar</a>
      </div>
    </div>

  </div>

  <!-- Controles (flechas) -->
  <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>

<!-- =================== SECCIN PROMOCIONES =================== -->

<section id="promos" class="container-fluid my-5"> 
  <!-- 
  <section>: agrupa contenido relacionado, en este caso toda la secci贸n de promociones
  id="promos": Le da un identificador general a esta seccion
  class="container-fluid my-5": usa clases de Bootstrap para un contenedor que ocupa todo el ancho y tiene margen vertical
  -->

  <!-- TITULO DE LA SECCION -->
  <!-- "text-start": usa bootstrap para alinear texto a la izquierda
        "fw-bold": texto en negrita
        "style": estilos CSS directos para color y fuente
  -->
  <h2 class="text-start fw-bold" style="color:#e6b800; font-family:'Oswald', sans-serif;">
    PROMOCIONES
  </h2>

<!-- Grid para dividir la pantala segun el disositivo en 5 columnas-->
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4 mt-3">

  <!-- Bot贸n agregar producto (solo visible para admin) -->
  <!--"hidden" deja este boton invisible de entrada, despues en el bloque de JS definimos que lo muestre solo si el rol es de admin-->
  <div class="text-center my-3" id="btn-add-promo" hidden>
    <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#modalAddProduct" data-category="promo"><!--Un boton rojo que abre un modal con id=modalAddProduct y que es de la categoria de "promos"-->
      <i class="bi bi-plus-circle"></i> Agregar producto
    </button>
  </div>

  <!-- Card de la promo 1 -->
  <div class="col"><!--Cada producto ocupa una columna -->
    <div class="card h-100 rounded-4"><!--"card" define esto como una estrcutura de card estandar de bootstrap/"h-100" hace que la tarjeta tenga altura completa dentro de la fila/"rounded" hace que los bordes sean redondeados-->
      <div class="card-img-top bg-dark rounded-top-4" style="height:180px;"></div><!--Espacio para las imagenes-->
      <div class="card-body text-center" style="background-color:#e6b800; border-radius:0 0 1rem 1rem;">
        <h5 class="card-title fw-bold text-dark">Producto1</h5>
        <p class="card-text text-dark">Descripci贸n del producto</p>
        <p class="fw-bold text-dark">$4.990</p>
        
        <!-- Bot贸n cliente -->
        <button class="btn btn-light text-dark fw-bold">Agregar al carrito</button>

        <!-- Botones solo para admin -->
        <div class="mt-2 justify-content-center gap-2 admin-actions" hidden>
          <button class="btn btn-sm btn-outline-light btn-edit" data-category="promo">Editar</button>
          <button class="btn btn-sm btn-outline-danger btn-delete" data-category="promo">Eliminar</button>
        </div>
      </div>
    </div>
  </div>



<!-- Modal gen茅rico para agregar/editar productos -->
<div class="modal fade" id="modalAddProduct" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content bg-dark text-light rounded-4">
      <div class="modal-header border-0">
        <h5 class="modal-title" id="modalProductTitle">Agregar producto</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <form id="productForm">
          <input type="hidden" id="productCategory">
          <input type="hidden" id="editIndex">

          <div class="mb-3">
            <label class="form-label">Nombre del producto</label>
            <input type="text" class="form-control" id="productName" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Descripci贸n</label>
            <textarea class="form-control" id="productDesc" rows="2" required></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Precio</label>
            <input type="number" class="form-control" id="productPrice" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Foto (URL por ahora)</label>
            <input type="text" class="form-control" id="productImg" placeholder="Recursos_Esteticos/img/producto.jpg">
          </div>

          <button type="submit" class="btn btn-warning fw-bold w-100">Guardar</button>
        </form>
      </div>
    </div>
  </div>
</div>

</div>

<!-- =================== SECCIN CARRITO =================== -->
<section id="carrito" class="container my-5" hidden>
  <h2 class="fw-bold mb-4" style="color:#e6b800; font-family:'Oswald', sans-serif;">
    Tu Carrito
  </h2>
  <div class="table-responsive">
    <table class="table table-dark table-striped align-middle text-center">
      <thead>
        <tr>
          <th>Producto</th>
          <th>Precio</th>
          <th>Cantidad</th>
          <th>Total</th>
          <th>Acci贸n</th>
        </tr>
      </thead>
      <tbody id="carrito-body">
        <!-- Aqu铆 se insertan los productos -->
      </tbody>
    </table>
  </div>
  <div class="d-flex justify-content-between align-items-center mt-3">
    <h4 id="carrito-total">Total: $0</h4>
    <button class="btn btn-success fw-bold">Ir a pagar</button>
  </div>
</section>


<!-- =================== MODAL LOGIN =================== -->
<div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered"> <!-- modal m谩s ancho -->
    <div class="modal-content bg-dark text-light rounded-4">
      <div class="modal-header border-0">
        <h5 class="modal-title">Acceso a Bocatto</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          
          <!-- Columna Crear cuenta -->
          <div class="col-md-6 border-end">
            <h6 class="fw-bold mb-3">驴Nuevo aqu铆?</h6>
            <p class="small">Crea una cuenta para acceder a promociones y seguimiento de pedidos.</p>
            <form id="registerForm">
              <button type="submit" class="btn btn-outline-warning w-100">Crear cuenta</button>
            </form>
          </div>

          <!-- Columna Iniciar sesi贸n -->
          <div class="col-md-6">
            <h6 class="fw-bold mb-3">驴Ya tienes cuenta?</h6>
            <form id="loginForm">
              <div class="mb-3">
                <label for="loginEmail" class="form-label">Correo electr贸nico</label>
                <input type="email" class="form-control" id="loginEmail" required>
              </div>
              <div class="mb-3">
                <label for="loginPass" class="form-label">Contrase帽a</label>
                <input type="password" class="form-control" id="loginPass" required>
              </div>
              <button type="submit" class="btn btn-warning w-100">Iniciar sesi贸n</button>
            </form>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>

  <!-- Bootstrap JS (para que funcione el carrusel y el navbar en m贸viles) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  
<!--Aqui empiesa el webeo de JS, que paja simular-->
<script>

// ------------------------------SIMULACION DE LOGIN/LOGOUT------------------------------
  
    let userRole = "visitante"; 
    // valores posibles: "visitante", "cliente", "admin"

    document.getElementById('loginForm').addEventListener('submit', function(e) {  //Se engancha un listener, que espera a que se envie el formulario de login, "e.preventDefault();" evita que se recargue la pagina
      e.preventDefault();
      // toma los valores escritos en los campos del formulario
      const email = document.getElementById('loginEmail').value; 
      const pass = document.getElementById('loginPass').value;
      // Aqui se simula la validacion del login
      if (email === "admin@bocatto.cl" && pass === "admin123") {
        userRole = "admin";
        alert("Bienvenido ADMIN");
      } else {
        userRole = "cliente";
        alert("Bienvenido cliente " + email);
      }

      // Actualizar vista del navbar seg煤n rol
      actualizarNavbar();

      // Cierra modal login despues de que se logean
      const modal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
      modal.hide();
    });
    // --- Logout ---
    document.getElementById('btn-logout').addEventListener('click', function() {
      userRole = "visitante";
      alert("Sesi贸n cerrada");
      actualizarNavbar();
    });

// ---------------------------------------SIMULACION DE REGISTRO---------------------------------------

    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault(); // evita refrescar la p谩gina

      alert("Cuenta creada con 茅xito . Ahora puedes iniciar sesi贸n.");
      // M谩s adelante se podr铆a guardar en base de datos
    });

    // --- Actualiza navbar seg煤n el rol actual ---
function actualizarNavbar() {
  // Aqui se guardan todos los botones presentes en el navbar y se les asigna a una variable
  const btnLogin = document.getElementById('btn-login');
  const btnPedidos = document.getElementById('btn-pedidos');
  const btnCarrito = document.getElementById('btn-carrito');
  const btnAdmin = document.getElementById('btn-admin');
  const btnLogout = document.getElementById('btn-logout');

  // Ponemos todos los botones en hidden por defecto y segun el rol mas adelante vemos cuales mostramos
  btnLogin.hidden = true;
  btnPedidos.hidden = true;
  btnCarrito.hidden = true;
  btnAdmin.hidden = true;
  btnLogout.hidden = true;
  // Aqui vemos cuales botones mostramos segun el rol
  if (userRole === "visitante") {
    btnLogin.hidden = false;
  } else if (userRole === "cliente") {
    btnPedidos.hidden = false;
    btnCarrito.hidden = false;
    btnLogout.hidden = false;
  } else if (userRole === "admin") {
    btnAdmin.hidden = false;
    btnLogout.hidden = false;
  }
    // Mostrar botones de admin en cards y secciones
  document.querySelectorAll('.admin-actions').forEach(el => el.hidden = (userRole !== "admin"));
  document.querySelectorAll('.admin-actions').forEach(el => {
    if (userRole === "admin") {
      el.classList.add("d-flex");
      el.hidden = false;
    } else {
      el.classList.remove("d-flex");
      el.hidden = true;
    }
  });



// ================== ADMIN PRODUCTOS ==================

// Guardar producto
document.getElementById('productForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const category = document.getElementById('productCategory').value;
  const name = document.getElementById('productName').value;
  const desc = document.getElementById('productDesc').value;
  const price = document.getElementById('productPrice').value;
  const img = document.getElementById('productImg').value || "Recursos_Esteticos/img/default.jpg";

  const editIndex = document.getElementById('editIndex').value;

  const row = document.querySelector(`#${category} .row`);

  if (editIndex === "") {
    // Crear nueva card
    const col = document.createElement('div');
    col.classList.add('col');
    col.innerHTML = `
      <div class="card h-100 rounded-4">
        <div class="card-img-top bg-dark rounded-top-4" style="height:180px; background:url('${img}') center/cover;"></div>
        <div class="card-body text-center" style="background-color:#e6b800; border-radius:0 0 1rem 1rem;">
          <h5 class="card-title fw-bold text-dark">${name}</h5>
          <p class="card-text text-dark">${desc}</p>
          <p class="fw-bold text-dark">$${price}</p>
          <button class="btn btn-light text-dark fw-bold">Agregar al carrito</button>
          <div class="mt-2 d-flex justify-content-center gap-2 admin-actions" hidden>
            <button class="btn btn-sm btn-outline-light btn-edit" data-category="${category}">Editar</button>
            <button class="btn btn-sm btn-outline-danger btn-delete" data-category="${category}">Eliminar</button>
          </div>
        </div>
      </div>
    `;
    row.appendChild(col);
  } else {
    // Editar card existente
    const card = row.children[editIndex].querySelector('.card-body');
    card.querySelector('.card-title').innerText = name;
    card.querySelector('.card-text').innerText = desc;
    card.querySelector('.fw-bold.text-dark').innerText = `$${price}`;
    row.children[editIndex].querySelector('.card-img-top').style.background = `url('${img}') center/cover`;
  }

  // Reset modal
  document.getElementById('productForm').reset();
  document.getElementById('editIndex').value = "";

  bootstrap.Modal.getInstance(document.getElementById('modalAddProduct')).hide();
});

// Detectar click en "Agregar producto"
document.querySelectorAll('[id^=btn-add-]').forEach(btn => {
  btn.addEventListener('click', function() {
    document.getElementById('modalProductTitle').innerText = "Agregar producto";
    document.getElementById('productCategory').value = this.dataset.category;
    document.getElementById('editIndex').value = "";
  });
});

// Detectar Editar/Eliminar
document.addEventListener('click', function(e) {
  if (e.target.classList.contains('btn-edit')) {
    const category = e.target.dataset.category;
    const row = document.querySelector(`#${category} .row`);
    const col = e.target.closest('.col');
    const index = Array.from(row.children).indexOf(col);

    const card = col.querySelector('.card-body');
    document.getElementById('productName').value = card.querySelector('.card-title').innerText;
    document.getElementById('productDesc').value = card.querySelector('.card-text').innerText;
    document.getElementById('productPrice').value = card.querySelector('.fw-bold.text-dark').innerText.replace('$','');
    document.getElementById('productImg').value = "";

    document.getElementById('modalProductTitle').innerText = "Editar producto";
    document.getElementById('productCategory').value = category;
    document.getElementById('editIndex').value = index;

    new bootstrap.Modal(document.getElementById('modalAddProduct')).show();
  }

  if (e.target.classList.contains('btn-delete')) {
    const category = e.target.dataset.category;
    const row = document.querySelector(`#${category} .row`);
    const col = e.target.closest('.col');
    row.removeChild(col);
  }
  // ================== CARRITO ==================
let carrito = [];

// Funci贸n para renderizar carrito
function renderCarrito() {
  const tbody = document.getElementById("carrito-body");
  tbody.innerHTML = "";
  let total = 0;

  carrito.forEach((item, index) => {
    const subtotal = item.precio * item.cantidad;
    total += subtotal;

    tbody.innerHTML += `
      <tr>
        <td>${item.nombre}</td>
        <td>$${item.precio}</td>
        <td>
          <input type="number" min="1" value="${item.cantidad}" 
            class="form-control form-control-sm w-50 mx-auto" 
            onchange="actualizarCantidad(${index}, this.value)">
        </td>
        <td>$${subtotal}</td>
        <td>
          <button class="btn btn-sm btn-danger" onclick="eliminarDelCarrito(${index})">
            Eliminar
          </button>
        </td>
      </tr>
    `;
  });

  document.getElementById("carrito-total").innerText = `Total: $${total}`;
  document.getElementById("cart-count").innerText = carrito.length;
}

// Actualizar cantidad
function actualizarCantidad(index, nuevaCantidad) {
  carrito[index].cantidad = parseInt(nuevaCantidad);
  renderCarrito();
}

// Eliminar producto
function eliminarDelCarrito(index) {
  carrito.splice(index, 1);
  renderCarrito();
}

// Detectar clicks en "Agregar al carrito"
document.addEventListener("click", function (e) {
  if (e.target && e.target.textContent.includes("Agregar al carrito")) {
    if (userRole !== "cliente") {
      alert("Debes iniciar sesi贸n como cliente para usar el carrito.");
      return;
    }

    const card = e.target.closest(".card-body");
    const nombre = card.querySelector(".card-title").innerText;
    const precio = parseInt(card.querySelector(".fw-bold.text-dark").innerText.replace("$", ""));

    // Buscar si el producto ya est谩 en el carrito
    const existe = carrito.find(item => item.nombre === nombre);
    if (existe) {
      existe.cantidad++;
    } else {
      carrito.push({ nombre, precio, cantidad: 1 });
    }

    renderCarrito();
    document.getElementById("carrito").hidden = false; // mostrar carrito al menos 1 vez
  }
});

});





</script>

</body>
</html>